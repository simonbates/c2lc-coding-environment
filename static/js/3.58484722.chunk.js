(this["webpackJsonpc2lc-coding-environment"]=this["webpackJsonpc2lc-coding-environment"]||[]).push([[3],{116:function(e,t,n){"use strict";n.r(t);var i=n(0),o=n.n(i),r=(n(19),new(window.AudioContext||window.webkitAudioContext)),a=r.createAnalyser(),s={getAudioContext:function(){return r},getAnalyser:function(){return a},resetAnalyser:function(){a=r.createAnalyser()},decodeAudioData:function(){r.decodeAudioData(audioData).then((function(e){}))}};var c=void 0,u=void 0,l=void 0,d=[],f=void 0,v=void 0,p=void 0,h=void 0,y=void 0,g=void 0,m=void 0,w={audio:!0,video:!1};navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;var b=function(){function e(t,n,i,o,r){var a=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.startRecording=function(){if(f=Date.now(),l){if(u&&"suspended"===u.state&&u.resume(),l&&"paused"===l.state)return void l.resume();if(u&&l&&"inactive"===l.state)l.start(10),u.createMediaStreamSource(v).connect(c),h&&h()}else navigator.mediaDevices?(console.log("getUserMedia supported."),navigator.mediaDevices.getUserMedia(w).then((function(e){v=e,l=MediaRecorder.isTypeSupported(p.mimeType)?new MediaRecorder(e,p):new MediaRecorder(e),h&&h(),l.onstop=a.onStop,l.ondataavailable=function(e){d.push(e.data),m&&m(e.data)},(u=s.getAudioContext()).resume().then((function(){c=s.getAnalyser(),l.start(10),u.createMediaStreamSource(v).connect(c)}))}))):alert("Your browser does not support audio recording")},h=t,y=n,g=i,m=o,p=r}return e.prototype.stopRecording=function(){l&&"inactive"!==l.state&&(l.stop(),v.getAudioTracks().forEach((function(e){e.stop()})),l=null,s.resetAnalyser())},e.prototype.onStop=function(e){var t=new Blob(d,{type:p.mimeType});d=[];var n={blob:t,startTime:f,stopTime:Date.now(),options:p,blobURL:window.URL.createObjectURL(t)};y&&y(n),g&&g(n)},e}(),S=void 0,A={create:function(e){var t=s.getAudioContext(),n=s.getAnalyser();if(void 0===S){var i=t.createMediaElementSource(e);i.connect(n),S=i}n.connect(t.destination)}},R={visualizeSineWave:function(e,t,n,i,o,r){var a=s.getAnalyser(),c=a.fftSize,u=new Uint8Array(c);e.clearRect(0,0,n,i),function l(){requestAnimationFrame(l),(a=s.getAnalyser()).getByteTimeDomainData(u),e.fillStyle=o,e.fillRect(0,0,n,i),e.lineWidth=2,e.strokeStyle=r,e.beginPath();for(var d=1*n/c,f=0,v=0;v<c;v++){var p=u[v]/128*i/2;0===v?e.moveTo(f,p):e.lineTo(f,p),f+=d}e.lineTo(t.width,t.height/2),e.stroke()}()},visualizeFrequencyBars:function(e,t,n,i,o,r){var a=this,c=s.getAnalyser();c.fftSize=256;var u=c.frequencyBinCount,l=new Uint8Array(u);e.clearRect(0,0,n,i),function t(){requestAnimationFrame(t),(c=s.getAnalyser()).getByteFrequencyData(l),e.fillStyle=o,e.fillRect(0,0,n,i);for(var d=n/u*2.5,f=void 0,v=0,p=0;p<u;p++){f=l[p];a.hexToRgb(r);e.fillStyle=r,e.fillRect(v,i-f/2,d,f/2),v+=d+1}}()},visualizeFrequencyCircles:function(e,t,n,i,o,r){var a=s.getAnalyser();a.fftSize=32;var c=a.frequencyBinCount,u=new Uint8Array(c);e.clearRect(0,0,n,i),function t(){requestAnimationFrame(t),(a=s.getAnalyser()).getByteFrequencyData(u);for(var l=new Uint8Array(c/3),d=0;d<c;d+=3){for(var f=0,v=0;v<3;v++)f+=u[d+v];l[d/3]=f/3}e.clearRect(0,0,n,i),e.beginPath(),e.arc(n/2,i/2,Math.min(i,n)/2,0,2*Math.PI),e.fillStyle=o,e.fill();var p=Math.min(i,n)/2/l.length;e.strokeStyle=r;for(var h=0;h<l.length;h++){e.beginPath();var y=p*h+p*(l[h]/128);e.arc(n/2,i/2,y,0,2*Math.PI),e.stroke()}}()},hexToRgb:function(e){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null}};var C=function(e){function t(n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,e.call(this,n));return i.visualize=function(){var e=i.props,t=e.backgroundColor,n=e.strokeColor,o=e.width,r=e.height,a=e.visualSetting,s=i.state,c=s.canvas,u=s.canvasCtx;"sinewave"===a?R.visualizeSineWave(u,c,o,r,t,n):"frequencyBars"===a?R.visualizeFrequencyBars(u,c,o,r,t,n):"frequencyCircles"===a&&R.visualizeFrequencyCircles(u,c,o,r,t,n)},i.state={microphoneRecorder:null,canvas:null,canvasCtx:null},i}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.componentDidMount=function(){var e=this,t=this.props,n=t.onSave,i=t.onStop,o=t.onStart,r=t.onData,a=t.audioElem,s=t.audioBitsPerSecond,c=t.mimeType,u=this.refs.visualizer,l=u.getContext("2d"),d={audioBitsPerSecond:s,mimeType:c};a?(A.create(a),this.setState({canvas:u,canvasCtx:l},(function(){e.visualize()}))):this.setState({microphoneRecorder:new b(o,i,n,r,d),canvas:u,canvasCtx:l},(function(){e.visualize()}))},t.prototype.clear=function(){var e=this.props,t=e.width,n=e.height;this.state.canvasCtx.clearRect(0,0,t,n)},t.prototype.render=function(){var e=this.props,t=e.record,n=e.onStop,i=e.width,r=e.height,a=this.state,s=a.microphoneRecorder;a.canvasCtx;return t?s&&s.startRecording():s&&(s.stopRecording(n),this.clear()),o.a.createElement("canvas",{ref:"visualizer",height:r,width:i,className:this.props.className})},t}(i.Component);C.propTypes={},C.defaultProps={backgroundColor:"rgba(255, 255, 255, 0.5)",strokeColor:"#000000",className:"visualizer",audioBitsPerSecond:128e3,mimeType:"audio/webm;codecs=opus",record:!1,width:640,height:100,visualSetting:"sinewave"},n.d(t,"ReactMic",(function(){return C}))}}]);
//# sourceMappingURL=3.58484722.chunk.js.map